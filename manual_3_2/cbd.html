{"id":"105","uid":"1","name":"cbd","title":"CBD\u6a21\u5f0f","category_id":"1","description":"","pid":"17","model_id":"2","root":"1","type":"1","position":"0","link_id":"0","cover_id":"0","display":"0","dateline":"0","attach":"0","view":"0","comment":"0","extend":"0","level":"82","create_time":"1381563240","update_time":"1382274275","status":"1","parse":"0","content":"<p>ThinkPHP\u4ece3.0\u7248\u672c\u5f00\u59cb\u5f15\u5165\u4e86\u5168\u65b0\u7684<strong>CBD\uff08\u6838\u5fc3Core+\u884c\u4e3aBehavior+\u9a71\u52a8Driver\uff09<\/strong>\u67b6\u6784\u6a21\u5f0f\uff0c\u56e0\u4e3a\u4ece\u5e95\u5c42\u5f00\u59cb\uff0c\u6846\u67b6\u5c31\u91c7\u7528\u6838\u5fc3+\u884c\u4e3a+\u9a71\u52a8\u7684\u67b6\u6784\u4f53\u7cfb\uff0c\u6838\u5fc3\u4fdd\u7559\u4e86\u6700\u5173\u952e\u7684\u90e8\u5206\uff0c\u5e76\u5728\u91cd\u8981\u4f4d\u7f6e\u8bbe\u7f6e\u4e86\u6807\u7b7e\u7528\u4ee5\u6807\u8bb0\uff0c\u5176\u4ed6\u529f\u80fd\u90fd\u91c7\u7528\u884c\u4e3a\u6269\u5c55\u548c\u9a71\u52a8\u7684\u65b9\u5f0f\u7ec4\u5408\uff0c\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u8981\uff0c\u5bf9\u67d0\u4e2a\u6807\u7b7e\u4f4d\u7f6e\u8fdb\u884c\u884c\u4e3a\u6269\u5c55\u6216\u8005\u66ff\u6362\uff0c\u5c31\u53ef\u4ee5\u65b9\u4fbf\u7684\u5b9a\u5236\u6846\u67b6\u5e95\u5c42\uff0c\u4e5f\u53ef\u4ee5\u5728\u5e94\u7528\u5c42\u6dfb\u52a0\u81ea\u5df1\u7684\u6807\u7b7e\u4f4d\u7f6e\u548c\u6dfb\u52a0\u5e94\u7528\u884c\u4e3a\u3002\u800c\u6807\u7b7e\u4f4d\u7f6e\u7c7b\u4f3c\u4e8eAOP\u6982\u5ff5\u4e2d\u7684\u201c\u5207\u9762\u201d\uff0c\u884c\u4e3a\u90fd\u662f\u56f4\u7ed5\u8fd9\u4e2a\u201c\u5207\u9762\u201d\u6765\u8fdb\u884c\u7f16\u7a0b\u3002<\/p>\n\n<h2>Core\uff08\u6838\u5fc3\uff09<\/h2>\n\n<p>ThinkPHP\u7684\u6838\u5fc3\u90e8\u5206\u5305\u62ec\u6838\u5fc3\u51fd\u6570\u5e93\u3001\u60ef\u4f8b\u914d\u7f6e\u3001\u6838\u5fc3\u7c7b\u5e93\uff08\u5305\u62ec\u57fa\u7840\u7c7b\u548c\u5185\u7f6e\u9a71\u52a8\u53ca\u6838\u5fc3\u884c\u4e3a\uff09\uff0c\u8fd9\u4e9b\u662fThinkPHP\u5fc5\u4e0d\u53ef\u5c11\u7684\u90e8\u5206\u3002<\/p>\n\n<pre><code>ThinkPHP\/Common\/functions.php \/\/ \u6838\u5fc3\u51fd\u6570\u5e93\nThinkPHP\/Conf\/convention.php  \/\/ \u60ef\u4f8b\u914d\u7f6e\u6587\u4ef6\nThinkPHP\/Conf\/debug.php  \/\/ \u60ef\u4f8b\u8c03\u8bd5\u914d\u7f6e\u6587\u4ef6\nThinkPHP\/Mode\/common.php  \/\/ \u666e\u901a\u6a21\u5f0f\u5b9a\u4e49\u6587\u4ef6\nThinkPHP\/Library\/Think \/\/ \u6838\u5fc3\u7c7b\u5e93\u5305\nThinkPHP\/Library\/Behavior \/\/ \u7cfb\u7edf\u884c\u4e3a\u7c7b\u5e93\nThinkPHP\/Library\/Think\/App.class.php \/\/ \u6838\u5fc3\u5e94\u7528\u7c7b\nThinkPHP\/Library\/Think\/Behavior.class.php \/\/ \u57fa\u7840\u884c\u4e3a\u7c7b\nThinkPHP\/Library\/Think\/Cache.class.php \/\/ \u6838\u5fc3\u7f13\u5b58\u7c7b\nThinkPHP\/Library\/Think\/Controller.class.php \/\/ \u57fa\u7840\u63a7\u5236\u5668\u7c7b\nThinkPHP\/Library\/Think\/Db.class.php \/\/ \u6570\u636e\u5e93\u64cd\u4f5c\u7c7b\nThinkPHP\/Library\/Think\/Dispatcher.class.php \/\/ URL\u89e3\u6790\u8c03\u5ea6\u7c7b\nThinkPHP\/Library\/Think\/Exception.class.php \/\/ \u7cfb\u7edf\u57fa\u7840\u5f02\u5e38\u7c7b\nThinkPHP\/Library\/Think\/Hook.class.php \/\/ \u7cfb\u7edf\u94a9\u5b50\u7c7b\nThinkPHP\/Library\/Think\/Log.class.php \/\/ \u7cfb\u7edf\u65e5\u5fd7\u8bb0\u5f55\u7c7b\nThinkPHP\/Library\/Think\/Model.class.php \/\/ \u7cfb\u7edf\u57fa\u7840\u6a21\u578b\u7c7b\nThinkPHP\/Library\/Think\/Route.class.php \/\/ \u7cfb\u7edf\u8def\u7531\u7c7b\nThinkPHP\/Library\/Think\/Storage.class.php \/\/ \u7cfb\u7edf\u5b58\u50a8\u7c7b\nThinkPHP\/Library\/Think\/Template.class.php \/\/ \u5185\u7f6e\u6a21\u677f\u5f15\u64ce\u7c7b\nThinkPHP\/Library\/Think\/Think.class.php \/\/ \u7cfb\u7edf\u5f15\u5bfc\u7c7b\nThinkPHP\/Library\/Think\/View.class.php \/\/ \u7cfb\u7edf\u89c6\u56fe\u7c7b\n<\/code><\/pre>\n\n<p>Behavior\u76ee\u5f55\u4e0b\u9762\u662f\u7cfb\u7edf\u5185\u7f6e\u7684\u4e00\u4e9b\u884c\u4e3a\u7c7b\u5e93\uff0c\u5185\u7f6e\u9a71\u52a8\u5219\u5206\u5e03\u5728\u5404\u4e2a\u4e0d\u540c\u7684\u9a71\u52a8\u76ee\u5f55\u4e0b\u9762\uff08\u53c2\u8003\u4e0b\u9762\u7684\u9a71\u52a8\u90e8\u5206\uff09\u3002<\/p>\n\n<h2>Driver\uff08\u9a71\u52a8\uff09<\/h2>\n\n<p>3.2\u5728\u67b6\u6784\u8bbe\u8ba1\u4e0a\u66f4\u52a0\u5f3a\u5316\u4e86\u9a71\u52a8\u7684\u8bbe\u8ba1\uff0c\u66ff\u4ee3\u4e86\u4e4b\u524d\u7684\u5f15\u64ce\u548c\u6a21\u5f0f\u6269\u5c55\uff0c\u5e76\u4e14\u6539\u8fdb\u4e86\u884c\u4e3a\u7684\u8bbe\u8ba1\uff0c\u4f7f\u5f97\u6846\u67b6\u6574\u4f53\u66f4\u52a0\u7075\u6d3b\uff0c\u5e76\u4e14\u7531\u4e8e\u5728\u9700\u8981\u5199\u5165\u6570\u636e\u7684\u529f\u80fd\u7c7b\u5e93\u4e2d\u90fd\u91c7\u7528\u4e86\u9a71\u52a8\u5316\u7684\u8bbe\u8ba1\u601d\u60f3\uff0c\u6240\u4ee5\u4f7f\u5f97\u65b0\u7684\u6846\u67b6\u80fd\u591f\u8f7b\u677e\u6ee1\u8db3\u5206\u5e03\u5f0f\u90e8\u7f72\u7684\u9700\u6c42\uff0c\u5bf9\u4e91\u5e73\u53f0\u7684\u652f\u6301\u53ef\u4ee5\u66f4\u7b80\u5355\u7684\u5b9e\u73b0\u4e86\u3002\u56e0\u6b64\uff0c\u5728\u65b0\u7248\u7684\u6269\u5c55\u91cc\u9762\uff0c\u5df2\u7ecf\u53d6\u6d88\u4e86\u5f15\u64ce\u6269\u5c55\u548c\u6a21\u5f0f\u6269\u5c55\uff0c\u6539\u6210\u914d\u7f6e\u4e0d\u540c\u7684\u5e94\u7528\u6a21\u5f0f\u5373\u53ef\u3002<\/p>\n\n<p>\u9a71\u52a8\u5305\u62ec<\/p>\n\n<pre><code>ThinkPHP\/Library\/Think\/Cache\/Driver \/\/ \u7f13\u5b58\u9a71\u52a8\u7c7b\u5e93\nThinkPHP\/Library\/Think\/Db\/Driver \/\/ \u6570\u636e\u5e93\u9a71\u52a8\u7c7b\u5e93\nThinkPHP\/Library\/Think\/Log\/Driver \/\/ \u65e5\u5fd7\u8bb0\u5f55\u9a71\u52a8\u7c7b\u5e93\nThinkPHP\/Library\/Think\/Session\/Driver \/\/ Session\u9a71\u52a8\u7c7b\u5e93\nThinkPHP\/Library\/Think\/Storage\/Driver \/\/ \u5b58\u50a8\u9a71\u52a8\u7c7b\u5e93\nThinkPHP\/Library\/Think\/Template\/Driver \/\/ \u7b2c\u4e09\u65b9\u6a21\u677f\u5f15\u64ce\u9a71\u52a8\u7c7b\u5e93\nThinkPHP\/Library\/Think\/Template\/TagLib \/\/ \u5185\u7f6e\u6a21\u677f\u5f15\u64ce\u6807\u7b7e\u5e93\u6269\u5c55\u7c7b\u5e93\n<\/code><\/pre>\n\n<h2>Behavior\uff08\u884c\u4e3a\uff09<\/h2>\n\n<p>\u884c\u4e3a\uff08Behavior\uff09\u662fThinkPHP\u6269\u5c55\u673a\u5236\u4e2d\u6bd4\u8f83\u5173\u952e\u7684\u4e00\u9879\u6269\u5c55\uff0c\u884c\u4e3a\u65e2\u53ef\u4ee5\u72ec\u7acb\u8c03\u7528\uff0c\u4e5f\u53ef\u4ee5\u7ed1\u5b9a\u5230\u67d0\u4e2a\u6807\u7b7e\uff08\u4f4d\uff09\u4e2d\u8fdb\u884c\u4fa6\u542c\u3002\u8fd9\u91cc\u7684\u884c\u4e3a\u6307\u7684\u662f\u4e00\u4e2a\u6bd4\u8f83\u62bd\u8c61\u7684\u6982\u5ff5\uff0c\u4f60\u53ef\u4ee5\u60f3\u8c61\u6210\u5728\u5e94\u7528\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e2a\u52a8\u4f5c\u6216\u8005\u5904\u7406\uff0c\u5728\u6846\u67b6\u7684\u6267\u884c\u6d41\u7a0b\u4e2d\uff0c\u5404\u4e2a\u4f4d\u7f6e\u90fd\u53ef\u4ee5\u6709\u884c\u4e3a\u4ea7\u751f\uff0c\u4f8b\u5982\u8def\u7531\u68c0\u6d4b\u662f\u4e00\u4e2a\u884c\u4e3a\uff0c\u9759\u6001\u7f13\u5b58\u662f\u4e00\u4e2a\u884c\u4e3a\uff0c\u7528\u6237\u6743\u9650\u68c0\u6d4b\u4e5f\u662f\u884c\u4e3a\uff0c\u5927\u5230\u4e1a\u52a1\u903b\u8f91\uff0c\u5c0f\u5230\u6d4f\u89c8\u5668\u68c0\u6d4b\u3001\u591a\u8bed\u8a00\u68c0\u6d4b\u7b49\u7b49\u90fd\u53ef\u4ee5\u5f53\u505a\u662f\u4e00\u4e2a\u884c\u4e3a\uff0c\u751a\u81f3\u8bf4\u4f60\u5e0c\u671b\u7ed9\u4f60\u7684\u7f51\u7ad9\u7528\u6237\u7684\u7b2c\u4e00\u6b21\u8bbf\u95ee\u5f39\u51faHello\uff0cworld\uff01\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u79cd\u884c\u4e3a\uff0c\u884c\u4e3a\u7684\u5b58\u5728\u8ba9\u4f60\u65e0\u9700\u6539\u52a8\u6846\u67b6\u548c\u5e94\u7528\uff0c\u800c\u5728\u5916\u56f4\u901a\u8fc7\u6269\u5c55\u6216\u8005\u914d\u7f6e\u6765\u6539\u53d8\u6216\u8005\u589e\u52a0\u4e00\u4e9b\u529f\u80fd\u3002<\/p>\n\n<p>\u800c\u4e0d\u540c\u7684\u884c\u4e3a\u4e4b\u95f4\u4e5f\u5177\u6709\u4f4d\u7f6e\u5171\u540c\u6027\uff0c\u6bd4\u5982\uff0c\u6709\u4e9b\u884c\u4e3a\u7684\u4f5c\u7528\u4f4d\u7f6e\u90fd\u662f\u5728\u5e94\u7528\u6267\u884c\u524d\uff0c\u6709\u4e9b\u884c\u4e3a\u90fd\u662f\u5728\u6a21\u677f\u8f93\u51fa\u4e4b\u540e\uff0c\u6211\u4eec\u628a\u8fd9\u4e9b\u884c\u4e3a\u53d1\u751f\u4f5c\u7528\u7684\u4f4d\u7f6e\u79f0\u4e4b\u4e3a<strong>\u6807\u7b7e\uff08\u4f4d\uff09<\/strong>\uff0c\u4e5f\u53ef\u4ee5\u79f0\u4e4b\u4e3a\u94a9\u5b50\uff0c\u5f53\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u5230\u8fd9\u4e2a\u6807\u7b7e\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u88ab\u62e6\u622a\u4e0b\u6765\uff0c\u7edf\u4e00\u6267\u884c\u76f8\u5173\u7684\u884c\u4e3a\uff0c\u7c7b\u4f3c\u4e8eAOP\u7f16\u7a0b\u4e2d\u7684\u201c\u5207\u9762\u201d\u7684\u6982\u5ff5\uff0c\u7ed9\u67d0\u4e00\u4e2a\u6807\u7b7e\u7ed1\u5b9a\u76f8\u5173\u884c\u4e3a\u5c31\u6210\u4e86\u4e00\u79cd\u7c7bAOP\u7f16\u7a0b\u7684\u601d\u60f3\u3002<\/p>\n\n<h5>\u7cfb\u7edf\u6807\u7b7e\u4f4d<\/h5>\n\n<p>\u7cfb\u7edf\u6838\u5fc3\u63d0\u4f9b\u7684\u6807\u7b7e\u4f4d\u7f6e\u5305\u62ec\uff08\u6309\u7167\u6267\u884c\u987a\u5e8f\u6392\u5217\uff09\uff1a<\/p>\n\n<ul>\n<li>app_init \u5e94\u7528\u521d\u59cb\u5316\u6807\u7b7e\u4f4d <\/li>\n<li>module_check \u6a21\u5757\u68c0\u6d4b\u6807\u7b7e\u4f4d\uff08<strong>3.2.1\u7248\u672c\u65b0\u589e<\/strong>\uff09<\/li>\n<li>path_info PATH_INFO\u68c0\u6d4b\u6807\u7b7e\u4f4d <\/li>\n<li>app_begin \u5e94\u7528\u5f00\u59cb\u6807\u7b7e\u4f4d <\/li>\n<li>action_name \u64cd\u4f5c\u65b9\u6cd5\u540d\u6807\u7b7e\u4f4d <\/li>\n<li>action_begin \u63a7\u5236\u5668\u5f00\u59cb\u6807\u7b7e\u4f4d <\/li>\n<li>view_begin \u89c6\u56fe\u8f93\u51fa\u5f00\u59cb\u6807\u7b7e\u4f4d <\/li>\n<li>view_template \u89c6\u56fe\u6a21\u677f\u89e3\u6790\u6807\u7b7e\u4f4d <\/li>\n<li>view_parse \u89c6\u56fe\u89e3\u6790\u6807\u7b7e\u4f4d <\/li>\n<li>template_filter \u6a21\u677f\u89e3\u6790\u8fc7\u6ee4\u6807\u7b7e\u4f4d<\/li>\n<li>view_filter \u89c6\u56fe\u8f93\u51fa\u8fc7\u6ee4\u6807\u7b7e\u4f4d <\/li>\n<li>view_end \u89c6\u56fe\u8f93\u51fa\u7ed3\u675f\u6807\u7b7e\u4f4d <\/li>\n<li>action_end \u63a7\u5236\u5668\u7ed3\u675f\u6807\u7b7e\u4f4d <\/li>\n<li>app_end \u5e94\u7528\u7ed3\u675f\u6807\u7b7e\u4f4d <\/li>\n<\/ul>\n\n<p>\u5728\u6bcf\u4e2a\u6807\u7b7e\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2a\u884c\u4e3a\uff0c\u884c\u4e3a\u7684\u6267\u884c\u987a\u5e8f\u6309\u7167\u5b9a\u4e49\u7684\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\u3002\u9664\u975e\u524d\u9762\u7684\u884c\u4e3a\u91cc\u9762\u4e2d\u65ad\u6267\u884c\u4e86\uff08\u67d0\u4e9b\u884c\u4e3a\u53ef\u80fd\u9700\u8981\u4e2d\u65ad\u6267\u884c\uff0c\u4f8b\u5982\u68c0\u6d4b\u673a\u5668\u4eba\u6216\u8005\u975e\u6cd5\u6267\u884c\u884c\u4e3a\uff09\uff0c\u5426\u5219\u4f1a\u7ee7\u7eed\u4e0b\u4e00\u4e2a\u884c\u4e3a\u7684\u6267\u884c\u3002<\/p>\n\n<p>\u9664\u4e86\u8fd9\u4e9b\u7cfb\u7edf\u5185\u7f6e\u6807\u7b7e\u4e4b\u5916\uff0c\u5f00\u53d1\u4eba\u5458\u8fd8\u53ef\u4ee5\u5728\u5e94\u7528\u4e2d\u6dfb\u52a0\u81ea\u5df1\u7684\u5e94\u7528\u6807\u7b7e\uff0c\u5728\u4efb\u4f55\u9700\u8981\u62e6\u622a\u7684\u4f4d\u7f6e\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\u5373\u53ef\uff1a<\/p>\n\n<pre><code>tag('my_tag'); \/\/ \u6dfb\u52a0my_tag \u6807\u7b7e\u4fa6\u542c\n\/\/ \u4e0b\u9762\u7684\u5199\u6cd5\u4f5c\u7528\u4e00\u81f4\n\\Think\\Hook::listen('my_tag');\n<\/code><\/pre>\n\n<p>tag\u51fd\u6570\u7528\u4e8e\u8bbe\u7f6e\u67d0\u4e2a\u6807\u7b7e\u4f4d\uff0c\u53ef\u4ee5\u4f20\u5165\u5e76\u4e14\u53ea\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u5982\u679c\u9700\u8981\u4f20\u5165\u591a\u4e2a\u53c2\u6570\uff0c\u8bf7\u4f7f\u7528\u6570\u7ec4\uff0c<\/p>\n\n<pre><code>tag('my_tag',$params); \/\/ \u6dfb\u52a0my_tag \u6807\u7b7e\u4fa6\u542c\n<\/code><\/pre>\n\n<p>\u8be5\u53c2\u6570\u4e3a\u5f15\u7528\u4f20\u503c\uff0c\u6240\u4ee5\u53ea\u80fd\u4f20\u5165\u53d8\u91cf\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u4f20\u503c\u662f\u9519\u8bef\u7684\uff1a<\/p>\n\n<pre><code>tag('my_tag','param'); \/\/ \u6dfb\u52a0my_tag \u6807\u7b7e\u4fa6\u542c\n<\/code><\/pre>\n\n<h5>\u6838\u5fc3\u884c\u4e3a<\/h5>\n\n<p>\u7cfb\u7edf\u7684\u5f88\u591a\u6838\u5fc3\u529f\u80fd\u4e5f\u662f\u91c7\u7528\u884c\u4e3a\u6269\u5c55\u7ec4\u88c5\u7684\uff0c\u5bf9\u4e8e\u6ee1\u8db3\u9879\u76ee\u65e5\u76ca\u7eb7\u7e41\u590d\u6742\u7684\u9700\u6c42\u548c\u5b9a\u5236\u5e95\u5c42\u6846\u67b6\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u65b9\u4fbf\u548c\u53ef\u80fd\u6027\u3002<\/p>\n\n<p>\u6838\u5fc3\u884c\u4e3a\u4f4d\u4e8e <code>ThinkPHP\/Behavior\/<\/code> \u76ee\u5f55\u4e0b\u9762\uff0c\u6846\u67b6\u6838\u5fc3\u5185\u7f6e\u7684\u884c\u4e3a\u5305\u62ec\u5982\u4e0b\uff1a<\/p>\n\n<table>\n<thead>\n<tr>\n  <th>\u884c\u4e3a\u540d\u79f0<\/th>\n  <th>\u8bf4\u660e<\/th>\n  <th>\u5bf9\u5e94\u6807\u7b7e\u4f4d\u7f6e<\/th>\n<\/tr>\n<\/thead>\n<tbody>\n<tr>\n  <td>BuildLite<\/td>\n  <td>\u751f\u6210Lite\u6587\u4ef6\uff083.2.1\u7248\u672c\u65b0\u589e\uff09<\/td>\n  <td>app_init<\/td>\n<\/tr>\n<tr>\n  <td>ParseTemplate<\/td>\n  <td>\u6a21\u677f\u6587\u4ef6\u89e3\u6790\uff0c\u5e76\u652f\u6301\u7b2c\u4e09\u65b9\u6a21\u677f\u5f15\u64ce\u9a71\u52a8<\/td>\n  <td>view_parse<\/td>\n<\/tr>\n<tr>\n  <td>ShowPageTrace<\/td>\n  <td>\u9875\u9762Trace\u529f\u80fd\u884c\u4e3a\uff0c\u5b8c\u6210\u9875\u9762Trace\u529f\u80fd<\/td>\n  <td>view_end<\/td>\n<\/tr>\n<tr>\n  <td>ShowRuntime<\/td>\n  <td>\u8fd0\u884c\u65f6\u95f4\u663e\u793a\u884c\u4e3a\uff0c\u5b8c\u6210\u8fd0\u884c\u65f6\u95f4\u663e\u793a<\/td>\n  <td>view_filter<\/td>\n<\/tr>\n<tr>\n  <td>TokenBuild<\/td>\n  <td>\u4ee4\u724c\u751f\u6210\u884c\u4e3a\uff0c\u5b8c\u6210\u8868\u5355\u4ee4\u724c\u7684\u81ea\u52a8\u751f\u6210<\/td>\n  <td>view_filter<\/td>\n<\/tr>\n<tr>\n  <td>ReadHtmlCache<\/td>\n  <td>\u8bfb\u53d6\u9759\u6001\u7f13\u5b58\u884c\u4e3a<\/td>\n  <td>app_init<\/td>\n<\/tr>\n<tr>\n  <td>WriteHtmlCache<\/td>\n  <td>\u751f\u6210\u9759\u6001\u7f13\u5b58\u884c\u4e3a<\/td>\n  <td>view_filter<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n\n<h5>\u884c\u4e3a\u5b9a\u4e49<\/h5>\n\n<p>\u81ea\u5b9a\u4e49\u7684\u6269\u5c55\u884c\u4e3a\u53ef\u4ee5\u653e\u5728\u6838\u5fc3\u6216\u8005\u5e94\u7528\u76ee\u5f55\uff0c\u53ea\u8981\u9075\u5faa\u547d\u540d\u7a7a\u95f4\u7684\u5b9a\u4e49\u89c4\u5219\u5373\u53ef\u3002\n\u884c\u4e3a\u7c7b\u7684\u547d\u540d\u91c7\u7528\uff1a\u884c\u4e3a\u540d\u79f0\uff08\u9a7c\u5cf0\u6cd5\uff0c\u9996\u5b57\u6bcd\u5927\u5199\uff09+Behavior \u884c\u4e3a\u7c7b\u7684\u5b9a\u4e49\u65b9\u5f0f\u5982\u4e0b\uff1a<\/p>\n\n<pre><code>namespace Home\\Behavior;\nuse Think\\Behavior;\nclass TestBehavior extends Behavior {\n     \/\/ \u884c\u4e3a\u6269\u5c55\u7684\u6267\u884c\u5165\u53e3\u5fc5\u987b\u662frun\n     public function run(&amp;$params){\n         if(C('TEST_PARAM')) {\n             echo 'RUNTEST BEHAVIOR '.$params;\n         }\n     }\n}\n<\/code><\/pre>\n\n<p><strong>3.2.1\u7248\u672c<\/strong>\u5f00\u59cb\uff0c\u884c\u4e3a\u7c7b\u7684\u5b9a\u4e49\u65e0\u9700\u7ee7\u627f<code>Think\\Behavior<\/code>\u7c7b\uff0c\u6240\u4ee5\uff0c\u4e0a\u9762\u7684\u5b9a\u4e49\u53ef\u4ee5\u7b80\u5316\u4e3a\uff1a<\/p>\n\n<pre><code>namespace Home\\Behavior;\nclass TestBehavior {\n     \/\/ \u884c\u4e3a\u6269\u5c55\u7684\u6267\u884c\u5165\u53e3\u5fc5\u987b\u662frun\n     public function run(&amp;$params){\n         if(C('TEST_PARAM')) {\n             echo 'RUNTEST BEHAVIOR '.$params;\n         }\n     }\n}\n<\/code><\/pre>\n\n<p>\u884c\u4e3a\u7c7b\u5fc5\u987b\u5b9a\u4e49\u6267\u884c\u5165\u53e3\u65b9\u6cd5<code>run<\/code>,\u7531\u4e8e\u884c\u4e3a\u7684\u8c03\u7528\u673a\u5236\u5f71\u54cd\uff0crun\u65b9\u6cd5\u4e0d\u9700\u8981\u4efb\u4f55\u8fd4\u56de\u503c\uff0c\u6240\u6709\u8fd4\u56de\u90fd\u901a\u8fc7\u5f15\u7528\u8fd4\u56de\u3002<\/p>\n\n<blockquote>\n  <p>run\u65b9\u6cd5\u7684\u53c2\u6570\u53ea\u5141\u8bb8\u4e00\u4e2a\uff0c\u4f46\u53ef\u4ee5\u4f20\u5165\u6570\u7ec4\u3002<\/p>\n<\/blockquote>\n\n<h5>\u884c\u4e3a\u7ed1\u5b9a<\/h5>\n\n<p>\u884c\u4e3a\u5b9a\u4e49\u5b8c\u6210\u540e\uff0c\u5c31\u9700\u8981\u7ed1\u5b9a\u5230\u67d0\u4e2a\u6807\u7b7e\u4f4d\u7f6e\u624d\u80fd\u751f\u6548\uff0c\u5426\u5219\u662f\u4e0d\u4f1a\u6267\u884c\u7684\u3002<\/p>\n\n<p>\u6211\u4eec\u9700\u8981\u5728\u5e94\u7528\u7684\u884c\u4e3a\u5b9a\u4e49\u6587\u4ef6<code>tags.php<\/code>\u6587\u4ef6\u4e2d\u8fdb\u884c\u884c\u4e3a\u548c\u6807\u7b7e\u7684\u4f4d\u7f6e\u5b9a\u4e49\uff0c\u683c\u5f0f\u5982\u4e0b\uff1a<\/p>\n\n<pre><code>return array(\n     '\u6807\u7b7e\u540d\u79f01'=&gt;array('\u884c\u4e3a\u540d1','\u884c\u4e3a\u540d2',...), \n     '\u6807\u7b7e\u540d\u79f02'=&gt;array('\u884c\u4e3a\u540d1','\u884c\u4e3a\u540d2',...), \n );\n<\/code><\/pre>\n\n<p>\u6807\u7b7e\u540d\u79f0\u5305\u62ec\u6211\u4eec\u524d\u9762\u5217\u51fa\u7684\u7cfb\u7edf\u6807\u7b7e\u548c\u5e94\u7528\u4e2d\u81ea\u5df1\u5b9a\u4e49\u7684\u6807\u7b7e\u540d\u79f0\uff0c\u6bd4\u5982\u4f60\u9700\u8981\u5728app_init\u6807\u7b7e\u4f4d\u7f6e\u5b9a\u4e49\u4e00\u4e2aCheckLangBehavior\u884c\u4e3a\u7c7b\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528\uff1a<\/p>\n\n<pre><code>return array(\n  'app_init'=&gt;array('Home\\Behavior\\CheckLang'),\n    \/\/ **\u5982\u679c\u662f3.2.1\u7248\u672c \u9700\u8981\u6539\u6210\uff08\u540e\u9762\u4e0d\u518d\u91cd\u590d\u8bf4\u660e\uff09**\n    \/\/ 'app_init'=&gt;array('Home\\Behavior\\CheckLangBehavior'),\n);\n<\/code><\/pre>\n\n<p>\u53ef\u4ee5\u7ed9\u4e00\u4e2a\u6807\u7b7e\u4f4d\u5b9a\u4e49\u591a\u4e2a\u884c\u4e3a\uff0c\u884c\u4e3a\u7684\u6267\u884c\u987a\u5e8f\u5c31\u662f\u5b9a\u4e49\u7684\u5148\u540e\u987a\u5e8f\uff0c\u4f8b\u5982\uff1a<\/p>\n\n<pre><code>return array(\n  'app_init'=&gt;array(\n    'Home\\Behavior\\CheckLang',\n    'Home\\Behavior\\CronRun'\n   ),\n);\n<\/code><\/pre>\n\n<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0btags.php\u4e2d\u5b9a\u4e49\u7684\u884c\u4e3a\u4f1a\u5e76\u5165\u7cfb\u7edf\u884c\u4e3a\u4e00\u8d77\u6267\u884c\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u7cfb\u7edf\u7684\u884c\u4e3a\u5b9a\u4e49\u4e2dapp_init\u6807\u7b7e\u4e2d\u5df2\u7ecf\u5b9a\u4e49\u4e86\u5176\u4ed6\u884c\u4e3a\uff0c\u5219\u4f1a\u9996\u5148\u6267\u884c\u7cfb\u7edf\u884c\u4e3a\u6269\u5c55\u4e2d\u5b9a\u4e49\u7684\u884c\u4e3a\uff0c\u7136\u540e\u518d\u6267\u884c\u9879\u76ee\u884c\u4e3a\u4e2d\u5b9a\u4e49\u7684\u884c\u4e3a\u3002\u4f8b\u5982\uff1a\n\u7cfb\u7edf\u884c\u4e3a\u5b9a\u4e49\u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86\uff1a<\/p>\n\n<pre><code>'app_begin'  =&gt;  array(\n    'Behavior\\ReadHtmlCache', \/\/ \u8bfb\u53d6\u9759\u6001\u7f13\u5b58\n),\n<\/code><\/pre>\n\n<p>\u800c\u5e94\u7528\u884c\u4e3a\u5b9a\u4e49\u6587\u4ef6\u6709\u5b9a\u4e49\uff1a<\/p>\n\n<pre><code>'app_begin'  =&gt;  array(\n    'Home\\Behavior\\CheckModule',\n    'Home\\Behavior\\CheckLang',\n),\n<\/code><\/pre>\n\n<p>\u5219\u6700\u7ec8\u6267\u884c\u5230app_begin\u6807\u7b7e\uff08\u4f4d\uff09\u7684\u65f6\u5019\uff0c\u4f1a\u4f9d\u6b21\u6267\u884c\uff1a<\/p>\n\n<pre><code>Library\\Behavior\\ReadHtmlCache\nHome\\Behavior\\CheckModule\nHome\\Behavior\\CheckLang\n<\/code><\/pre>\n\n<p>\u4e09\u4e2a\u884c\u4e3a\uff08\u9664\u975e\u4e2d\u95f4\u67d0\u4e2a\u884c\u4e3a\u6709\u4e2d\u6b62\u6267\u884c\u7684\u64cd\u4f5c\uff09\u3002<\/p>\n\n<p>\u5982\u679c\u5e0c\u671b\u5e94\u7528\u7684\u884c\u4e3a\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u8986\u76d6\u7cfb\u7edf\u7684\u884c\u4e3a\u5b9a\u4e49\uff0c\u53ef\u4ee5\u6539\u4e3a\u4e3a\u5982\u4e0b\u65b9\u5f0f\uff1a<\/p>\n\n<pre><code>'app_begin'  =&gt;  array(\n    'Home\\Behavior\\CheckModule',\n    'Home\\Behavior\\CheckLang',\n    '_overlay'    =&gt;    true,\n),\n<\/code><\/pre>\n\n<p>\u5219\u6700\u7ec8\u6267\u884c\u5230app_begin\u6807\u7b7e\uff08\u4f4d\uff09\u7684\u65f6\u5019\uff0c\u4f1a\u4f9d\u6b21\u6267\u884c\u4e0b\u9762\u4e24\u4e2a\u884c\u4e3a\uff1a<\/p>\n\n<pre><code>Home\\Behavior\\CheckModule\nHome\\Behavior\\CheckLang\n<\/code><\/pre>\n\n<p>\u5e94\u7528\u884c\u4e3a\u7684\u5b9a\u4e49\u6ca1\u6709\u9650\u5236\uff0c\u4f60\u53ef\u4ee5\u628a\u4e00\u4e2a\u884c\u4e3a\u7ed1\u5b9a\u5230\u591a\u4e2a\u6807\u7b7e\u4f4d\u7f6e\u6267\u884c\uff0c\u4f8b\u5982\uff1a<\/p>\n\n<pre><code>return array(\n     'app_begin'=&gt;array('Home\\Behavior\\Test'), \/\/ \u5728app_begin \u6807\u7b7e\u4f4d\u6dfb\u52a0Test\u884c\u4e3a\n     'app_end'=&gt;array('Home\\Behavior\\Test'), \/\/ \u5728app_end \u6807\u7b7e\u4f4d\u6dfb\u52a0Test\u884c\u4e3a\n );\n<\/code><\/pre>\n\n<h5>\u5355\u72ec\u6267\u884c<\/h5>\n\n<p>\u884c\u4e3a\u7684\u8c03\u7528\u4e0d\u4e00\u5b9a\u8981\u653e\u5230\u6807\u7b7e\u624d\u80fd\u8c03\u7528\uff0c\u5982\u679c\u9700\u8981\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u63a7\u5236\u5668\u4e2d\u6216\u8005\u5176\u4ed6\u5730\u65b9\u76f4\u63a5\u8c03\u7528\u884c\u4e3a\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u7528\u6237\u6743\u9650\u68c0\u6d4b\u5c01\u88c5\u6210\u4e00\u4e2a\u884c\u4e3a\u7c7b\uff0c\u4f8b\u5982\uff1a<\/p>\n\n<pre><code>namespace Home\\Behavior;\nuse Think\\Behavior;\nclass AuthCheckBehavior extends Behavior {\n\n     \/\/ \u884c\u4e3a\u6269\u5c55\u7684\u6267\u884c\u5165\u53e3\u5fc5\u987b\u662frun\n     public function run(&amp;$return){\n         if(C('USER_AUTH_ON')) {\n             \/\/ \u8fdb\u884c\u6743\u9650\u8ba4\u8bc1\u903b\u8f91 \u5982\u679c\u8ba4\u8bc1\u901a\u8fc7 $return = true;\n             \/\/ \u5426\u5219\u7528halt\u8f93\u51fa\u9519\u8bef\u4fe1\u606f\n         }\n     }\n}\n<\/code><\/pre>\n\n<p>\u5b9a\u4e49\u4e86AuthCheck\u884c\u4e3a\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u63a7\u5236\u5668\u7684_initialize\u65b9\u6cd5\u4e2d\u76f4\u63a5\u7528\u4e0b\u9762\u7684\u65b9\u5f0f\u8c03\u7528\uff1a<\/p>\n\n<pre><code>B('Home\\Behavior\\AuthCheck');\n<\/code><\/pre>\n","template":""}